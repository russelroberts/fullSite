{% extends "base.html" %}
{% block head %}
    <meta name = "description" content="Home page for STI data collection">
<!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- FullCalendar CSS -->
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.css" rel="stylesheet">

    <style>
        .disabled-date {
            background-color: #ddd !important;
            pointer-events: none;
            opacity: 0.6;
        }
    </style>
    {% endblock head %}
{% block title %}<title>Home</title>{% endblock title %}
{% block stylesheets %}
{% endblock stylesheets %}
{% block content %}
<div class="container mt-5">
    <h2 class="text-center">Bootstrap 5 Datepicker with Multi-select</h2>
    <div id="calendar"></div>
</div>

<!-- Bootstrap 5 JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- FullCalendar JS -->
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        let selectedDates = [];
        let disabledDates = ["2025-02-10", "2025-02-14", "2025-02-20"];  // Set non-selectable dates

        let calendarEl = document.getElementById('calendar');
        let calendar = new FullCalendar.Calendar(calendarEl, {
            initialView: 'dayGridMonth',  // Displays calendar on page load
            selectable: true,             // Allows selection
            selectOverlap: false,         // Prevents selecting disabled dates
            dateClick: function(info) {
                if (disabledDates.includes(info.dateStr)) return;  // Prevent selecting disabled dates
                
                if (selectedDates.includes(info.dateStr)) {
                    selectedDates = selectedDates.filter(date => date !== info.dateStr);
                } else {
                    selectedDates.push(info.dateStr);
                }

                calendar.refetchEvents(); // Refresh events
            },
            events: function(fetchInfo, successCallback, failureCallback) {
                let events = selectedDates.map(date => ({
                    title: "Selected",
                    start: date,
                    backgroundColor: "#007bff",
                    textColor: "#fff"
                }));

                disabledDates.forEach(date => {
                    events.push({
                        start: date,
                        display: "background",
                        className: "disabled-date"
                    });
                });

                successCallback(events);
            }
        });

        calendar.render();
    });
</script>
{% endblock content %}

